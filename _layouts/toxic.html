<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ page.title }}</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700;900&family=Oswald:wght@400;700&display=swap" rel="stylesheet">
  
  <style>
    :root{
      --bg:#0a0a0a; --muted:#aaaaaa; --white:#f5f5f5; --neon:#00ff88; --accent:#1a1a1a;
      --maxw:1000px;
    }
    *{box-sizing:border-box}
    /* El cuerpo del layout principal ya tiene estilos, pero aseguramos el fondo oscuro */
    body{
      margin:0;
      font-family:Inter,system-ui,Arial;
      background:linear-gradient(180deg,var(--bg),#070707);
      color:var(--white);
      -webkit-font-smoothing:antialiased
    }
    
    /* ESTILOS DE NAVEGACIÓN INTEGRADORAS */
    .nav-rock {
        max-width: var(--maxw);
        margin: 0 auto;
        padding: 20px 24px;
        display: flex;
        justify-content: flex-end;
        gap: 15px;
        background: #000000; /* Fondo negro sólido para el nav */
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    }
    .nav-rock a {
        color: var(--white);
        text-decoration: none;
        font-weight: 500;
        transition: color 0.3s ease;
    }
    .nav-rock a:hover {
        color: var(--neon);
    }
    
    /* ESTILOS ESPECÍFICOS DE LA PÁGINA 'TÓXICO EN EXCESO' */
    .container{max-width:var(--maxw);margin:40px auto;padding:24px}
    header{display:flex;align-items:center;gap:18px}
    .logo{width:84px;height:84px;border-radius:8px;background:linear-gradient(135deg,#111,#222);display:flex;align-items:center;justify-content:center;font-weight:900;font-family:Oswald,Inter;font-size:16px;letter-spacing:1px}
    h1{font-family:Oswald,Inter;font-size:36px;margin:0}
    p.lead{color:var(--muted);margin-top:6px}
    .cta{margin-top:18px}
    .btn{background:transparent;border:2px solid var(--neon);color:var(--neon);padding:10px 18px;border-radius:8px;font-weight:700;cursor:pointer;text-decoration:none}

    /* Harvey */
    .harvey{margin-top:36px;padding:22px;background:rgba(255,255,255,0.02);border-left:4px solid rgba(0,255,136,0.12);border-radius:8px}
    .harvey p{margin:0;font-style:italic;color:var(--white)}
    .harvey .small{color:var(--muted);margin-top:8px}
    /* Estilo del reproductor de audio general (escondido) */
    #audio-player-global { display: block; width: 100%; margin-top: 20px; }


    /* Tracks */
    .tracks{display:grid;grid-template-columns:1fr;gap:12px;margin-top:30px}
    .track{display:flex;align-items:center;gap:16px;padding:14px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);border-radius:8px}
    .track .meta{flex:1}
    .track h3{margin:0;font-size:18px}
    .track p{margin:6px 0;color:var(--muted)}
    /* Cambiamos la clase 'play' por 'play-audio' */
    .play-audio{background:var(--neon);color:#000;padding:8px 12px;border-radius:8px;font-weight:700;border:none;cursor:pointer}

    /* Letras */
    .letras{margin-top:26px;background:linear-gradient(180deg,#080808,#0e0e0e);padding:18px;border-radius:8px}
    .verso{font-family:Inter;font-size:16px;line-height:1.5;color:var(--white)}
    .highlight{color:var(--neon);font-weight:700}

    /* About */
    .about{margin-top:26px;padding:18px;background:rgba(255,255,255,0.01);border-radius:8px}

    footer{margin-top:40px;padding:18px;text-align:center;color:var(--muted);font-size:14px}
    a.icon{color:var(--muted);text-decoration:none;margin:0 8px}

    /* Responsive */
    @media (min-width:720px){
      .tracks{grid-template-columns:1fr}
      h1{font-size:48px}
    }

    /* small neon flicker */
    .neon{text-shadow:0 0 6px rgba(0,255,136,0.12),0 0 20px rgba(0,255,136,0.04)}
  </style>
</head>
<body>
  
  <nav class="nav-rock">
    {% for item in site.data.menus.main %}
        <a href="{{ item.url | relative_url }}">{{ item.title }}</a>
    {% endfor %}
  </nav>
  <div class="container">
    {{ content }}
    <audio id="audio-player-global" controls></audio>
  </div>

  <footer>
    © 2025 Hernán García Valdeavellano · "No vendemos discos, vendemos redención." 
    <div style="margin-top:8px">
      <a class="icon" href="#">YouTube</a> · <a class="icon" href="#">Instagram</a> · <a class="icon" href="#">Blog</a> · <a class="icon" href="mailto:contacto@toxicoenexceso.example">Contacto</a>
    </div>
  </footer>

  <script>
    // Referencias a los elementos globales
    const harveyBtn = document.getElementById('play-harvey');
    const harveyAudio = document.getElementById('harvey-audio');
    const globalAudioPlayer = document.getElementById('audio-player-global');
    
    // 1. LÓGICA DE LA VOZ DE HARVEY
    if (harveyBtn && harveyAudio) {
        harveyBtn.addEventListener('click', () => {
            // Detiene el reproductor de canciones si está sonando
            globalAudioPlayer.pause();
            
            if (harveyAudio.paused) {
                // RUTA DE HARVEY
                harveyAudio.src = "/assets/audio/harvey-voice.mp3"; 
                harveyAudio.play().catch(() => alert('Error: Sube el archivo harvey-voice.mp3 o permite reproducción automática.'));
                harveyBtn.textContent = 'Parar a Harvey';
            } else { 
                harveyAudio.pause(); 
                harveyBtn.textContent = 'Escucha a Harvey';
            }
        });
        
        // Evento para resetear el botón cuando Harvey termina de hablar
        harveyAudio.addEventListener('ended', () => {
            harveyBtn.textContent = 'Escucha a Harvey';
        });
    }

    // 2. LÓGICA DE REPRODUCCIÓN DE CANCIONES (MP3)
    document.querySelectorAll('.play-audio').forEach(btn => {
        btn.addEventListener('click', () => {
            const trackPath = btn.getAttribute('data-mp3');
            const trackTitle = btn.getAttribute('data-title');

            if (!trackPath) {
                alert('Falta la ruta MP3 (data-mp3) para esta canción.');
                return;
            }

            // Detiene a Harvey si está hablando
            if (harveyAudio && !harveyAudio.paused) {
                harveyAudio.pause();
                harveyBtn.textContent = 'Escucha a Harvey';
            }
            
            // Carga la nueva canción
            globalAudioPlayer.src = trackPath;
            globalAudioPlayer.play().catch(() => alert(`Error al reproducir ${trackTitle}. Asegúrate de subir el MP3 y permitir la reproducción.`));

            // Actualiza el texto del botón presionado
            document.querySelectorAll('.play-audio').forEach(b => {
                b.textContent = 'Escuchar';
                b.style.backgroundColor = 'var(--neon)';
            });
            btn.textContent = '▶️ Sonando...';
            btn.style.backgroundColor = '#ff0000'; // Color rojo para indicar que está activo

            // Opcional: desplazar para ver el reproductor
            window.scrollTo({top: globalAudioPlayer.offsetTop - 50, behavior: 'smooth'});
        });
    });

    // 3. SCROLL DEL BOTÓN PRINCIPAL
    document.getElementById('btn-hero') && document.getElementById('btn-hero').addEventListener('click', (e) => {
        e.preventDefault();
        document.getElementById('disco').scrollIntoView({behavior:'smooth'});
    });
  </script>
</body>
</html>
